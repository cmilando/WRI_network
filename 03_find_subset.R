#' ============================================================================
#' ////////////////////////////////////////////////////////////////////////////
#' Test with one K-monitors
#' 
#' ////////////////////////////////////////////////////////////////////////////
#' ============================================================================
system("R CMD SHLIB simann.f90")

dyn.unload("simann.so")

dyn.load("simann.so")

oo <- .Fortran("simann",
               S = as.integer(S),
               magic_n = as.integer(length(which(S == 1))),
               np = as.integer(nrow(site_pairs_sub)),
               nsites = as.integer(length(unique(site_pairs_sub$site_id))),
               site_pairs_sub = aa,
               row_lookup = bb,
               penalty = 1,
               SCORE = 0.,
               cooling_rate = 0.95,
               verbose = as.integer(1)) 

# confirming math
get_score(oo$S)
oo$SCORE

#' ============================================================================
#' ////////////////////////////////////////////////////////////////////////////
#' Now in parallel, computer for 1:N monitors 
#' 
#' ////////////////////////////////////////////////////////////////////////////
#' ============================================================================








#' ============================================================================
#' ////////////////////////////////////////////////////////////////////////////
#' Make the curve 
#' 
#' ////////////////////////////////////////////////////////////////////////////
#' ============================================================================